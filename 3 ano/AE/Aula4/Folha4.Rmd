---
title: "Exercícios — Regressão Linear Simples"
#author: "Seu Nome"
date: "`r format(Sys.time(), '%d/%m/%Y')`"
output:
  html_document:
    toc: true
    toc_depth: 2
#    number_sections: true
  pdf_document:
    toc: true
    number_sections: true
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
set.seed(123)
options(digits = 4)
suppressPackageStartupMessages({
  library(tidyverse)
  library(broom)
  # carregar (ou instalar) pacotes de dados interessantes
  pkgs <- c("palmerpenguins","nycflights13","gapminder")
  to_install <- pkgs[!pkgs %in% rownames(installed.packages())]
  if(length(to_install)) install.packages(to_install, quiet = TRUE)
  library(palmerpenguins)
  library(nycflights13)
  library(gapminder)
})
theme_set(theme_minimal())
```


- Responda **em R**, inserindo seus comandos nos *chunks* após cada exercício.  
- **Interprete** os coeficientes no contexto do problema.  
- Use gráficos e diagnóstico de resíduos para sustentar as suas conclusões.  

---

# Exercício 1 — Pinguins: morfologia e predição (palmerpenguins)

**Objetivo:** estimar como o comprimento da barbatana (*flipper_length_mm*) se relaciona com o comprimento do bico (*bill_length_mm*).

1. Construa um *scatterplot* de `flipper_length_mm` vs `bill_length_mm` (apenas indivíduos com valores completos).  
2. Ajuste o modelo linear simples `flipper_length_mm ~ bill_length_mm`.  
3. Interprete o intercept e o declive nas unidades do estudo. O sinal e a magnitude fazem sentido biologicamente?  
4. Faça predição pontual e **intervalo de predição** (95%) para um pinguim com `bill_length_mm = 45`.  
5. Analise resíduos (resíduos vs ajustados e QQ-plot). Comente possíveis violações dos pressupostos.

```{r ex1}
peng <- penguins |> drop_na(flipper_length_mm, bill_length_mm)
# seu código aqui
```


---

# Exercício 2 — Diamantes: preço e quilates (ggplot2::diamonds)

**Objetivo:** entender a relação entre o preço (`price`) e o peso em quilates (`carat`).

1. Faça um gráfico `price` vs `carat` com a reta de regressão simples.  
2. Ajuste `price ~ carat` e reporte o \(R^2\).  
3. Compare o ajuste linear com um modelo em escala log: `log(price) ~ log(carat)`. Qual apresenta resíduos mais “bem‐comportados”?  
4. Forneça predição e intervalo de predição (95%) para `carat = 1.0` no modelo escolhido.

```{r ex2}
data(diamonds, package = "ggplot2")
# seu código aqui
```


---

# Exercício 3 — Países: esperança média de vida e PIB (gapminder)

**Objetivo:** investigar a relação entre esperança média de vida (`lifeExp`) e PIB (`gdpPercap`) num **ano fixo**.

1. Selecione um ano (ex.: 2007). Faça `lifeExp` vs `gdpPercap` em escala log no eixo de renda.  
2. Compare dois modelos:  
   a) `lifeExp ~ gdpPercap`  
   b) `lifeExp ~ log(gdpPercap)`  
3. Interprete o declive do melhor modelo em termos práticos (como a variação de PIB se reflete na esperança média de vida).  
4. Analise os resíduos.

```{r ex3}
gm <- gapminder |> filter(year == 2007)
# seu código aqui
```


---

# Exercício 4 — Voos: atraso e distância (nycflights13)

**Objetivo:** avaliar se voos mais longos tendem a atrasar mais na descolagem.

1. Crie um *scatterplot* de `dep_delay` (min) vs `distance` (milhas) para voos de 2013 com valores completos; inclua a reta de regressão.  
2. Ajuste `dep_delay ~ distance`. Interprete o declive.  
3. Analise se alguns outliers dominam o ajustamento:  
   - reestime o modelo sem o(s) ponto(s) mais influente(s) e compare o declive.  
4. Discuta as limitações de usar apenas `distance` para prever atraso.


```{r ex4}
fl <- flights |> drop_na(dep_delay, distance)
# seu código aqui
```


---

# Exercício 5 — Predição para subgrupos (diamantes)

**Objetivo:** comparar relações por *cut* (lapidação), mas com **modelo separado simples** (ainda SLR dentro de cada grupo).

1. Selecione dois níveis de `cut` (ex.: "Ideal" e "Good").  
2. Para cada nível, ajuste `price ~ carat` e compare as inclinações.  
3. Comente diferenças substanciais e possíveis explicações (qualidade, mercado, etc.).  
4. Verifique diagnóstico de resíduos em cada subgrupo.


```{r ex5}
# seu código aqui
```


---

# Exercício 6 — Intervalos e teste para o declive (gapminder)

Para o melhor modelo do Exercício 3 (no ano escolhido):

1. Teste \(H_0:\ \beta_1=0\) a 5% e reporte o p-valor.  
2. Obtenha o **intervalo de confiança (95%)** para \(\beta_1\) e interprete no contexto.  


```{r ex6}
# seu código aqui
```

